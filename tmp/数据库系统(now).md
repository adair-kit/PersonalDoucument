# 四.数据库系统


## 三级模式 - 两级映射

|---|
|外模式（用户、视图）|
|（外模式-概念模式映射）|
|概念模式（表）|
|（概念模式-内模式）|
|内模式（文件级）|
|操作系统|
|物理数据库|

* 对表的操作属于 **模式级**，创建索引是 **内模式**

## 数据库设计过程

* 需求分析: 数据流图 , 数据字典 , 需求说明书
* 概念结构设计: 用户的数据模型(与DBMS无关的概念模型) E-R模型
* 逻辑结构设计: 视图 , 完整性约束即应用处理说明书 关系模式 <-(规范化理论)
* 物理设计: DBMS特性 硬件,OS特性

## E-R 模型

* 椭圆 : 属性
* 矩形 : 实体
* 菱形 : 联系 1:n m:n

集成方式:
1. 多个局部E-R图一次集成
2. 逐步集成,用累加的方式一次集成两个局部E-R

集成产生的冲突及解决办法
1. 属性冲突 : 包括属性域和属性取值冲突
2. 命名冲突 : 包括同名异义和异名同义
3. 结构冲突 : 包括同一个对象在不同应用中具有不同的抽象,以及同一实体在不同局部E-R图中所包含的属性个数和属性排列次序不完全相同

### E-R模型转关系模式
* 一个实体型转换为一个关系模式 : 1:1联系 1:n联系 m:n联系
* 三个以上实体间的一个多元联系
* 一对一最少转为2个关系模式,一对多最少转为2个关系模式,多对多最少转为3个关系模式..3个实体最少转为4个关系模式

## 关系代数

### 集合运算符

并
交
差
笛卡儿积
投影
选择
联结


|     |     |     |
| --- | --- | --- |

| 运算符  | 含义     | 英文              |
| ------- | -------- | ----------------- |
| $∪$ | 并       | Union             |
| $-$ | 差       | Difference        |
| $∩$  | 交       | Intersection      |
| $×$    | 笛卡尔积 | Cartesian Product |

### 比较运算符

| 运算符 | 含义     |
| ------ | -------- |
| $>$   | 大于     |
| $≥$   | 大于等于 |
| $<$    | 小于     |
| $≤$   | 小于等于 |
| $=$ | 等于     |
| $≠$ | 不等于   |

## 规范化理论-价值与用途

* 非规范化的关系模式,可能存在的问题包括 : 数据冗余,更新异常,插入异常,删除异常

## 范式

* **超键 :** 在关系中能唯一标识元组的属性集称为关系模式的超键
* **候选键/候选码/码 :** :不含有多余属性的超键称为候选键
* **主键 :** 用户选作元组标识的一个候选键作为主键
* **主属性 :** 包含在任何一个码中的属性称为主属性
* **非主属性 :** 不包含在任何一个候选码中的属性称为非主属性

* **完全函数依赖 :** 设X,Y是关系R的两个属性集合，X’是X的真子集，存在X→Y，但对每一个X’都有X’!→Y，则称Y完全函数依赖于X。
* **部分函数依赖 :** 设X,Y是关系R的两个属性集合，存在X→Y，若X’是X的真子集，存在X’→Y，则称Y部分函数依赖于X。
* **传递函数依赖 :** 设X,Y,Z是关系R中互不相同的属性集合，存在X→Y(Y !→X),Y→Z，则称Z传递函数依赖于X。

> **键 :** 又可以叫关键字,就有超关键字 ,候选关键字 ,主关键字...也可以称为码 候选码 ,主码

| 范式 | 描述                               | emmm                                                                                                         |
| ---- | ---------------------------------- | ------------------------------------------------------------------------------------------------------------ |
| 1NF  | 属性值都不可再分                   | 字段不能再分                                                                                                 |
| 2NF  | 消除非主属性对候选键的部分依赖     | 不能存在仅依赖候选键一部分的属性,候选键仅有一个属性就一定符合2NF                                             |
| 3NF  | 消除非主属性对候选键的传递依赖     | 非主属性必须依赖候选键,而不能依赖其他字段.非主属性只有一个一定符合3NF                                        |
| BCNF | 消除主属性对候选键的部分与传递依赖 | 1NF基础上每个属性不部分依赖于候选键也不传递依赖于候选键<br>3NF基础上消除主属性对于候选键的部分与传递函数依赖 |


## 模式分解

* 有损分解
* 无损分解

### 图表

1. 建立一张n列k行的表，每一列对应一个属性，每一行对应分解中的一个关系模式. 若关系模式包涵属性 对应填上aj 否则填上bij
2. 遍历每一个关系模式,找到具有相同符号的行.考察关系模式对应的列,若其中有aj,则全部改为aj,其他全部改为bmj,m为这些行的行号最小值
3. 若有一行称为a1,a2,...an则终止.且分解具有无损性.

### 公式(对于一分为二关系模式可用)

* U1∩U2→U1-U2 €F+ 或U1∩U2→ U2-U1€F+




## 考点
1. 关系代数 : 给出一个关系代数表达式找出等价的关系代数表达式 , 或给一个业务场景或完成什么只能写出关系代数表达式